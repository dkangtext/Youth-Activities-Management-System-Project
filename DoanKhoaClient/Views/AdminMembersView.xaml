<Window
    x:Class="DoanKhoaClient.Views.AdminMembersView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:DoanKhoaClient.Views"
    xmlns:vm="clr-namespace:DoanKhoaClient.ViewModels"
    mc:Ignorable="d"
    Title="AdminMembersView"
    WindowStartupLocation="CenterScreen"
    WindowState="Maximized"
    MinWidth="1024"
    MinHeight="768"
    Height="1036"
    Width="1440">

    <Window.Resources>
        <vm:AdminMembersViewModel x:Key="ViewModel"/>
    </Window.Resources>

    <Window.DataContext>
        <StaticResource ResourceKey="ViewModel"/>
    </Window.DataContext>

    <Grid x:Name="Admin_Members_Background"
          Width="1440"
          Height="1022.8">
        <Grid.Background>
            <LinearGradientBrush EndPoint="0.5,1"
                                 StartPoint="0.5,0">
                <GradientStop Color="#FFF6FCFF"
                              Offset="0.596"/>
                <GradientStop Color="#FFDBF3FF"
                              Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>

        <!-- Search Bar -->
        <TextBox x:Name="Admin_Members_tbSearch"
                 Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                 HorizontalAlignment="Left"
                 Margin="370,41,0,0"
                 TextWrapping="Wrap"
                 VerticalAlignment="Top"
                 Width="307"
                 Height="50"
                 Background="#FFDBF3FF"
                 BorderBrush="{x:Null}"/>

        <!-- Filter Dropdown -->
        <ComboBox Grid.Column="1"
                  Width="120"
                  Height="50"
                  Margin="685,41,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  ItemsSource="{Binding Roles}"
                  SelectedItem="{Binding SelectedRole}"
                  DisplayMemberPath="DisplayName"/>

        <!-- Left Navigation Panel -->
        <Border x:Name="Admin_Members_Dashboard"
                BorderBrush="Black"
                HorizontalAlignment="Left"
                Height="942"
                Margin="43,0,0,0"
                VerticalAlignment="Center"
                Width="288"
                CornerRadius="10,10,10,10">
            <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                    <GradientStop Color="#FFF6FCFF"
                                  Offset="0.04"/>
                    <GradientStop Color="#FFDBF3FF"
                                  Offset="0.46"/>
                    <GradientStop Color="#FF87ACCD"
                                  Offset="0.937"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <!-- Header Icons -->
        <Image x:Name="Admin_Members_iUsers"
               HorizontalAlignment="Left"
               Height="40"
               Margin="1358,46,0,0"
               VerticalAlignment="Top"
               Width="40"
               Source="/Views/Images/generic avatar.png"/>
        <Image x:Name="Admin_Members_iNotifications"
               HorizontalAlignment="Left"
               Height="40"
               Margin="1297,46,0,0"
               VerticalAlignment="Top"
               Width="40"
               Source="/Views/Images/light-notifications.png"/>
        <Image x:Name="ThemeToggleButton"
               HorizontalAlignment="Left"
               Height="40"
               Margin="1236,46,0,0"
               VerticalAlignment="Top"
               Width="40"
               Source="/Views/Images/dark.png"
               MouseDown="ThemeToggleButton_MouseDown"/>
        <Image x:Name="Admin_Members_iSearch"
               HorizontalAlignment="Left"
               Height="40"
               Margin="628,46,0,0"
               VerticalAlignment="Top"
               Width="40"
               Source="/Views/Images/search.png"/>

        <!-- Logo -->
        <Image x:Name="Admin_Members_iLogo"
               HorizontalAlignment="Left"
               Height="40"
               Margin="131,71,0,0"
               VerticalAlignment="Top"
               Width="112.38"
               Source="/Views/Images/header.png"/>

        <!-- Navigation Menu Items -->
        <StackPanel>
            <Button
                x:Name="SidebarHomeButton"
                Width="160"
                Height="30"
                Margin="102,203,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Background="Transparent"
                BorderThickness="0"
                Click="SidebarHomeButton_Click"
                Cursor="Hand"
                Style="{StaticResource NavigationButtonStyle}">
                <StackPanel Orientation="Horizontal"
                            Style="{StaticResource MenuItemStyle}">
                    <Image
                        x:Name="HomePage_iHome"
                        Width="30"
                        Height="30"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Source="/Views/Images/active-home.png"/>
                    <Label
                        x:Name="HomePage_lbHome"
                        Width="108"
                        Height="30"
                        Margin="30,0,0,0"
                        Padding="0,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Content="Home"
                        FontFamily="Segoe UI"
                        FontSize="20"
                        FontWeight="Bold"
                        Foreground="#597CA2"/>
                </StackPanel>
            </Button>
        </StackPanel>
        <Button
            x:Name="SidebarChatButton"
            Width="160"
            Height="30"
            Margin="102,279,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderThickness="0"
            Click="SidebarChatButton_Click"
            Cursor="Hand"
            Style="{StaticResource NavigationButtonStyle}">
            <StackPanel Orientation="Horizontal"
                        Style="{StaticResource MenuItemStyle}">
                <Image
                    x:Name="HomePage_iChat"
                    Width="30"
                    Height="30"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Source="/Views/Images/chat_bubble.png"/>
                <Label
                    x:Name="HomePage_lbChat"
                    Width="108"
                    Height="30"
                    Margin="30,0,0,0"
                    Padding="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="Chat"
                    FontFamily="Segoe UI"
                    FontSize="20"
                    FontWeight="Bold"/>
            </StackPanel>
        </Button>
        <Button
            x:Name="SidebarActivitiesButton"
            Width="160"
            Height="30"
            Margin="102,354,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderThickness="0"
            Click="SidebarActivitiesButton_Click"
            Cursor="Hand"
            Style="{StaticResource NavigationButtonStyle}">
            <StackPanel Orientation="Horizontal"
                        Style="{StaticResource MenuItemStyle}">
                <Image
                    x:Name="HomePage_Activities"
                    Width="30"
                    Height="30"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Source="/Views/Images/activities.png"/>
                <Label
                    x:Name="HomePage_lbActivities"
                    Width="108"
                    Height="30"
                    Margin="30,0,0,0"
                    Padding="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="Activities"
                    FontFamily="Segoe UI"
                    FontSize="20"
                    FontWeight="Bold"/>
            </StackPanel>
        </Button>
        <Button
            x:Name="SidebarMemberButton"
            Width="160"
            Height="30"
            Margin="102,432,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderThickness="0"
            Click="SidebarMembersButton_Click"
            Cursor="Hand"
            Style="{StaticResource NavigationButtonStyle}">
            <StackPanel Orientation="Horizontal"
                        Style="{StaticResource MenuItemStyle}">
                <Image
                    x:Name="HomePage_Task_iMembers"
                    Width="30"
                    Height="30"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Source="/Views/Images/members.png"/>
                <Label
                    x:Name="HomePage_lbMembers"
                    Width="108"
                    Height="30"
                    Margin="30,0,0,0"
                    Padding="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="Members"
                    FontFamily="Segoe UI"
                    FontSize="20"
                    FontWeight="Bold"/>
            </StackPanel>
        </Button>
        <Button
            x:Name="SidebarTaskButton"
            Width="160"
            Height="30"
            Margin="102,510,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderThickness="0"
            Click="SidebarTasksButton_Click"
            Cursor="Hand"
            Style="{StaticResource NavigationButtonStyle}">
            <StackPanel Orientation="Horizontal"
                        Style="{StaticResource MenuItemStyle}">
                <Image
                    x:Name="HomePage_iTasks"
                    Width="30"
                    Height="30"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Source="/Views/Images/tasks.png"/>
                <Label
                    x:Name="HomePage_lbTasks"
                    Width="108"
                    Height="30"
                    Margin="30,0,0,0"
                    Padding="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="Tasks"
                    FontFamily="Segoe UI"
                    FontSize="20"
                    FontWeight="Bold"/>
            </StackPanel>
        </Button>
        <Button
            x:Name="SidebarAdminButton"
            Width="160"
            Height="30"
            Margin="102,586,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="Transparent"
            BorderThickness="0"
            Click="SidebarAdminButton_Click"
            Cursor="Hand"
            Visibility="Collapsed"
            Style="{StaticResource NavigationButtonStyle}">
            <StackPanel Orientation="Horizontal"
                        Style="{StaticResource MenuItemStyle}">
                <Image
                    x:Name="HomePage_iAdmin"
                    Width="30"
                    Height="30"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Source="/Views/Images/admin_panel.png"/>
                <Label
                    x:Name="HomePage_lbAdmin"
                    Width="108"
                    Height="30"
                    Margin="30,0,0,0"
                    Padding="0,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="Admin"
                    FontFamily="Segoe UI"
                    FontSize="20"
                    FontWeight="Bold"/>
            </StackPanel>
        </Button>

        <!-- Admin submenu -->
        <StackPanel
            x:Name="AdminSubmenu"
            Margin="132,621,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Visibility="Collapsed">
            <Button
                x:Name="AdminTaskButton"
                Margin="0,5,0,5"
                Click="AdminTaskButton_Click"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand">
                <TextBlock
                    Text="Quản lý công việc"
                    FontSize="15"
                    Foreground="#042354"/>
            </Button>
            <Button
                x:Name="AdminMembersButton"
                Margin="0,5,0,5"
                Click="AdminMembersButton_Click"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand">
                <TextBlock
                    Text="Quản lý thành viên"
                    FontSize="15"
                    Foreground="#042354"/>
            </Button>
            <Button
                x:Name="AdminChatButton"
                Margin="0,5,0,5"
                Click="AdminChatButton_Click"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand">
                <TextBlock
                    Text="Quản lý chat"
                    FontSize="15"
                    Foreground="#042354"/>
            </Button>
            <Button
                x:Name="AdminActivitiesButton"
                Margin="0,5,0,5"
                Click="AdminActivitiesButton_Click"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand">
                <TextBlock
                    Text="Quản lý hoạt động"
                    FontSize="15"
                    Foreground="#042354"/>
            </Button>
        </StackPanel>
        <!-- Social Media Icons -->
        <Image x:Name="Admin_Members_iFacebook"
               HorizontalAlignment="Left"
               Height="24"
               Margin="175,926,0,0"
               VerticalAlignment="Top"
               Width="24"
               Source="/Views/Images/facebook.png"/>
        <Image x:Name="Admin_Members_iInstagram"
               HorizontalAlignment="Left"
               Height="24"
               Margin="135,926,0,0"
               VerticalAlignment="Top"
               Width="24"
               Source="/Views/Images/instagram.png"/>
        <Image x:Name="Admin_Members_iYoutube"
               HorizontalAlignment="Left"
               Height="24"
               Margin="215,926,0,0"
               VerticalAlignment="Top"
               Width="24"
               Source="/Views/Images/youtube.png"/>

        <!-- Page Title -->
        <Label x:Name="Admin_Members_lbInformation"
               Content="QUẢN LÝ THÀNH VIÊN"
               HorizontalAlignment="Left"
               HorizontalContentAlignment="Left"
               Height="40"
               Margin="365,153,0,0"
               VerticalAlignment="Top"
               Width="386"
               FontSize="32"
               Foreground="#042354"
               FontWeight="Bold"
               Padding="0,0,0,0"/>

        <!-- Separator Line -->
        <Rectangle HorizontalAlignment="Left"
                   Height="1"
                   Margin="365,293,0,0"
                   Stroke="Black"
                   VerticalAlignment="Top"
                   Width="1020"
                   RenderTransformOrigin="0.5,0.5">
            <Rectangle.RenderTransform>
                <TransformGroup>
                    <ScaleTransform ScaleY="-1"/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </Rectangle.RenderTransform>
        </Rectangle>

        <!-- Action Buttons -->
        <Button x:Name="AddMemberButton"
                Content="Thêm thành viên"
                Command="{Binding AddUserCommand}"
                HorizontalAlignment="Left"
                Height="40"
                Margin="365,219,0,0"
                VerticalAlignment="Top"
                Width="147"
                Background="#FF042354"
                FontSize="16"
                FontWeight="Bold"
                Foreground="#F6FCFF"/>

        <Button x:Name="RefreshButton"
                Content="Làm mới"
                Command="{Binding RefreshCommand}"
                HorizontalAlignment="Left"
                Height="40"
                Margin="534,219,0,0"
                VerticalAlignment="Top"
                Width="147"
                Background="#FF042354"
                FontSize="16"
                FontWeight="Bold"
                Foreground="#F6FCFF"/>


        <!-- Member List -->
        <ListView x:Name="MembersListView"
                  ItemsSource="{Binding FilteredUsers}"
                  SelectedItem="{Binding SelectedUser}"
                  Margin="370,330,55,41"
                  BorderThickness="1"
                  BorderBrush="#E0E0E0">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Tên đăng nhập"
                                    Width="150">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Username}"
                                           FontWeight="SemiBold"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Họ tên"
                                    Width="200">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding DisplayName}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Email"
                                    Width="200">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Email}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Vai trò"
                                    Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Role}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Trạng thái"
                                    Width="100">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text"
                                                    Value="Online"/>
                                            <Setter Property="Foreground"
                                                    Value="Green"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsOnline}"
                                                             Value="False">
                                                    <Setter Property="Text"
                                                            Value="Offline"/>
                                                    <Setter Property="Foreground"
                                                            Value="Gray"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Thao tác"
                                    Width="200">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Sửa"
                                            Width="60"
                                            Height="28"
                                            Margin="0,0,5,0"
                                            Command="{Binding DataContext.EditUserCommand, 
                                                RelativeSource={RelativeSource AncestorType={x:Type ListView}}}"
                                            CommandParameter="{Binding}"/>
                                    <Button Content="Xóa"
                                            Width="60"
                                            Height="28"
                                            Margin="0,0,5,0"
                                            Command="{Binding DataContext.DeleteUserCommand, 
                                                RelativeSource={RelativeSource AncestorType={x:Type ListView}}}"
                                            CommandParameter="{Binding}"/>
                                    <Button Content="Chi tiết"
                                            Width="65"
                                            Height="28"
                                            Command="{Binding DataContext.ViewUserDetailsCommand, 
                                                RelativeSource={RelativeSource AncestorType={x:Type ListView}}}"
                                            CommandParameter="{Binding}"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment"
                            Value="Stretch"/>
                    <Setter Property="Padding"
                            Value="8,6"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected"
                                 Value="True">
                            <Setter Property="Background"
                                    Value="#E3F2FD"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ToolTip>
                <ToolTip>
                    <TextBlock Text="Nhấn vào để chọn thành viên"/>
                </ToolTip>
            </ListView.ToolTip>
        </ListView>
    </Grid>
</Window>